# This file should be in the 'macro-logger-app' directory, 
# which is set as the 'Base directory' in Netlify build settings.

# 1. Redirect root to the app's base path
[[redirects]]
  from = "/"
  to = "/macro-logger/"
  status = 301 # Permanent redirect
  force = true

# 2. Rewrite specific known static files from public dir
# These are requested as /macro-logger/file.ext but exist as /file.ext in the deployment root.
[[redirects]]
  from = "/macro-logger/favicon.ico"
  to = "/favicon.ico"
  status = 200
[[redirects]]
  from = "/macro-logger/apple-touch-icon.png"
  to = "/apple-touch-icon.png"
  status = 200
[[redirects]]
  from = "/macro-logger/pwa-192x192.png"
  to = "/pwa-192x192.png"
  status = 200
[[redirects]]
  from = "/macro-logger/pwa-512x512.png"
  to = "/pwa-512x512.png"
  status = 200
[[redirects]]
  from = "/macro-logger/manifest.webmanifest" # Default name for VitePWA
  to = "/manifest.webmanifest"
  status = 200

# NEW/ADJUSTED: For PWA files typically at the root of 'dist'
[[redirects]]
  from = "/macro-logger/registerSW.js"
  to = "/registerSW.js"
  status = 200
[[redirects]]
  from = "/macro-logger/sw.js"
  to = "/sw.js"
  status = 200
# If vite-plugin-pwa uses workbox, it might generate workbox-*.js files too
[[redirects]]
  from = "/macro-logger/workbox-*:name.:ext"
  to = "/workbox-:name.:ext"
  status = 200

# 3. Rewrite Vite's bundled assets (typically in /assets/ subfolder)
# Request: /macro-logger/assets/file.js -> Serve: /assets/file.js
[[redirects]]
  from = "/macro-logger/assets/*"
  to = "/assets/:splat"
  status = 200

# 4. SPA Fallback for any other /macro-logger/ path
# This comes last. If a request like /macro-logger/today reaches here,
# it means it wasn't one of the specific files or assets above.
[[redirects]]
  from = "/macro-logger/*"
  to = "/index.html"
  status = 200 